(()=>{var a=e=>{const o=e.dataset.filterSource,i=e.dataset.filterTarget,n=e.querySelector("input"),a=e.querySelector("button[aria-controls]"),s=e.querySelector('button[type="reset"]'),t=new Awesomplete(n,{minChars:0,sort:!1,replace:function(e){this.input.value=e.label}});a.addEventListener("click",function(){t.ul.childNodes.length===0?t.evaluate():t.ul.hasAttribute("hidden")?t.open():t.close()}),s.addEventListener("click",()=>{n.value="",t.evaluate(),t.close()}),n.addEventListener("awesomplete-selectcomplete",e=>{const t=e.text.value;htmx.ajax("GET",t,{target:i,select:o})}),n.addEventListener("awesomplete-close",e=>{(e.reason==="blur"||e.reason==="esc")&&n.value===""&&s.click()})};function c(){const e=document.querySelector(".control-group--awesomplete");e!=null&&window.addEventListener("load",function(){a(e)})}function n(e){const t=document.querySelector(e);t.checked=localStorage.getItem("switchedTheme")==="true",t.addEventListener("change",function(e){e.currentTarget.checked===!0?localStorage.setItem("switchedTheme","true"):localStorage.removeItem("switchedTheme")})}function s(e){const t=document.querySelectorAll(e);document.addEventListener("click",function(e){t.forEach(t=>{const n=t.contains(e.target);n||t.removeAttribute("open")})})}function o(e){return fetch(e).then(e=>e.json()).then(e=>e.books).then(e=>e[Math.floor(Math.random()*e.length)])}function i(e){const n=e.querySelector("form"),s=e.querySelector(".dialog__title"),t=e.querySelector("img");return o=>(n.action=o.permalink,s.textContent=o.title,t.src=o.cover.url,t.width=o.cover.width,t.height=o.cover.height,e)}function t(){return e=>e.showModal()}function r(t,n){const s=t.returnValue;s==="continue"&&e(t,n)}function e(e,n){o(n).then(i(e)).then(t())}function l(t){const n=document.querySelector(t),s=document.querySelector(t+" + button");n!=null&&s!=null&&(n.addEventListener("close",()=>r(n,s.dataset.bookList)),s.addEventListener("click",()=>e(n,s.dataset.bookList)))}function d(e){return(t,n)=>{e.remove(t),e.add(n)}}function u(){const t=document.querySelector("#main-menu-toggle"),n=d(t.querySelector(".fas").classList),e=document.querySelector(".navigation__wrap--main");t.addEventListener("click",t=>{const s=e.dataset.open;s==="false"?(e.dataset.open="true",n("fa-bars","fa-times")):(e.dataset.open="false",n("fa-times","fa-bars")),t.preventDefault(),t.stopPropagation()})}function h(){const e=document.querySelectorAll(".menu--toc a");e.forEach(e=>e.addEventListener("click",t=>{e.scrollIntoView({inline:"center"})}))}function m(){u(),h()}c(),n("#theme-switch"),s(".tooltip"),l("#random-book-chooser"),m()})()