{{ define "main" }}

<main>
    <div class="pure-g">
        <div class="pure-u-1 pure-u-lg-1-2">
            <div class="content">
                <h1>{{ with .Params.Title }}{{ . }}{{ else }}{{ .Section | title }} - {{ .Data.Term | title }}{{ end }}</h1>

                {{ .Content }}
            </div>
        </div>
        <div class="pure-u-1 pure-u-lg-1-2">
            {{- $topics := slice -}}
            {{ range .Data.Pages }}
            {{ $topics = $topics | append .Params.topics }}
            {{ end }}
            <label for="filter-topic">Thema:</label>
            <select id="filter-topic" class="select-decorated">
                <option value="clear-topic-filter" selected="selected">alle</option>
                {{ range ($topics | uniq | sort) }}
                    <option value="{{ . | anchorize }}">{{ . }}</option>
                {{ end }}
            </select>

            <hr class="ruler-decorated">

            <div class="pure-g">
                {{ range sort .Data.Pages "Title" }}
                <a class="cover-u pure-u-1-2 pure-u-md-1-4 pure-u-lg-1-3" href="{{ .Permalink }}" data-topics="{{ range .Params.topics }}{{ . | anchorize }} {{end }}">
                    {{- with partial "book/cover" (dict "isbn" .Params.isbn "coversPath" $.Site.Params.books.coversPath) -}}
                    <img src="{{ .RelPermalink }}" width="{{ .Width }}" height="{{ .Height }}">
                    {{- end -}}
                </a>
                {{ end }}
            </div>
        </div>
    </div>
</main>

{{ $mainJs := resources.Get "js/book-topic-filter.js" | js.Build "book-topic-filter.js" | minify | fingerprint }}
<script src="{{ $mainJs.RelPermalink }}"></script>
{{ end }}